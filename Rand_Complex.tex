Let $q$ be a prime number and let $\Fq$ denote the field with $q$ elements. Let $n_m$ be a sequence of natural numbers. Consider the sequence of finite vector spaces $\Fqn{n_m}$ indexed by $m$ in the integers.  We iteratively construct a sequence $A_m$ of random $(n_{m-1})\times (n_m)$ matrices.

Suppose we know $A_{m}$. Let $A_{m+1}$ be a random $(n_{m})\times (n_{m+1})$ matrix whose entries are chosen i.i.d. uniformly from $\Fq$, subject to the condition that $A_{m+1}A_{m} = 0$. We shall see that it suffices to know only $\nul(A_m) = \dim\ker A_{m}$ in our investigation.

\begin{definition}
Let $n_m$ be a sequence of natural numbers. A \textbf{random chain complex} is a pair $(\Fqn{n_m},A_m)$, where $A_m$ is an iteratively defined sequence of random of $(n_{m-1})\times (n_m)$ matrices, as defined above.  
\end{definition}



We wish to investigate the probabilistic properties of the $m$-th Betti number for a random chain complex, $\beta_m := \dim(H_m(A_\ast; \Fqn{n}))$.  Recall that $H_m(A_\ast;\Fqn{n}) = \ker (A_{m})/ A_{m+1}(\Fqn{n})$, so $\beta_m = k - \rank(A_{m+1})$.  We are therefore interested in the probabilistic properties of $\rank(A_{m+1})$ given that $A_{m}A_{m+1} = 0$ and that $\nul(A_{m}) = k$. 


\begin{definition}

Let $r \leq k$ be a non-negative integer.  Define 
\[
  P^m_k(r) := \mathbb{P} 
  \left[\rank(A_{m+1}) = r|A_{m}A_{m+1} = 0, \nul(A_{m}) = k \right] \, .
\]
\end{definition}

As the $A_m$ are uniformly distributed, we immediately have that
\[
P^m_k(r) = \mathbb{P}\left[\beta_m = k-r | A_{m}A_{m+1} = 0, \nul(A_{m}) = k\right] \, .
\]


Lemma~\ref{Num_mbyn_rankr} gives us the following.
\begin{lemma}
\[
P^m_k(r) = \begin{cases}
  {\displaystyle \frac{\left(\prod_{j=0}^{r-1}\left(q^{n_{m+1}}-q^{j}\right)\right)
  \left(\prod_{j=0}^{r-1}\left(q^k - q^j \right) \right)}
  {q^{kn_{m+1}} \left(\prod_{j=0}^{r-1} \left(q^r-q^j\right)\right)}}
            					& \textrm{ if } k\neq 0,\\
           0					&  \textrm{ if }  r>k. 
            \end{cases}
\]
\end{lemma}

\mc{The following theorem is no longer true in general. It fails if
  $n_{m+1} < k$, but it is still true if $n_m = n_{m+1}$. One possible
  fix is to just impose $k \leq n_{m+1}$. This proposed fix may be 
  unnatural. In any case, there should be 
some condition on $k$ in the statement, since its a bound variable.}

\begin{theorem} 
Let $\beta_m$ be the $m$-th Betti number in the conditional chain complex.  Then 
\[
\mathbb{P}\left[\beta_m=0| A_{m}A_{m+1} = 0, \nul(A_{m}) = k \right] \to 1 \textrm{ as } q\to\infty.
\]
\end{theorem}

\begin{proof}\label{Condptoinfty}
We have
	\begin{eqnarray*}
	&&\mathbb{P}\left[\beta_m = 0|A_{m}A_{m+1} = 0, \nul(A_{m}) = k \right]\\ 
    &=& P^m_k(k)\\
    &=& \frac{\prod_{j=0}^{k-1}(q^{n_{m+1}}-q^{j})
		\prod_{j=0}^{k-1}(q^k - q^j )}
		{q^{kn_{m+1}} \prod_{j=0}^{k-1} (q^k-q^j)}\\
		&=& \frac{\prod_{j=0}^{k-1}(q^{n_{m+1}} - q^j)}
		{q^{kn_{m+1}}} \\
		%&=& \frac{\prod_{j=0}^{k-1}(q^{n_{m+1}} - q^j)}{q^{n_{m+1}k}}\\
		%&=& \frac{q^{kn_{m+1}}}{q^{kn_{m+1}}}\prod_{j=0}^{k-1}(1-q^{j-n_{m+1}})\\
		&=& \prod_{j=0}^{k-1} (1-q^{j-n_{m+1}}),
	\end{eqnarray*}
which tends to 1 as $q\to\infty$.  
\end{proof}

The previous theorem immediately leads to two corollaries.  

\begin{corollary}\label{condtozero}
Let $b$ be a positive integer that is less than or equal to $k$. Then 
\[
\mathbb{P}[\beta_m = b| A_{m}A_{m+1} = 0, \nul(A_{m}) = k ] \to 0 \textrm{ as } q\to\infty.
\]
\end{corollary}
\begin{proof}
We have that
	\begin{eqnarray*}
	&&\mathbb{P}[\beta_m = b \st A_{m}A_{m+1} = 0, \nul(A_{m}) = k ]\\
    &=& 1 - \sum_{j\neq b}\mathbb{P}[\beta_0 = j \st A_{m}A_{m+1} = 0, \nul(A_{m}) = k ]\\
    &\leq& 1 - \mathbb{P}(\beta_m = 0|A_{m}A_{m+1} = 0, \dim\ker(A_{m}) = k ).
	\end{eqnarray*}
By Theorem~\ref{Condptoinfty}, this goes to $0$ as $q$ goes to infinity.
\end{proof}

\begin{corollary}
$\mathbb{E}[\beta_m | A_{m}A_{m+1} = 0, \dim\ker(A_{m}) = k ] \to n$ as $q\to\infty$.
\begin{proof}
The conditional expectation of the $m$-th Betti number is given by
	\begin{eqnarray*}
	& & \mathbb{E}[\beta_m | A_{m}A_{m+1} = 0, \dim\ker(A_{m}) = k ]\\
	&=& \sum_{b=1}^n b \mathbb{P}(\beta_m = b | A_{m}A_{m+1} = 0, \dim\ker(A_{m}) = k ) \, .
	\end{eqnarray*}
By Corollary \ref{condtozero}, all terms with $b< n$ in this sum tend to 
$0$ as $q$ goes to infinity. 

On the other hand, when $b=n$, 
\[
n\mathbb{P}(\beta_m=0| A_{m}A_{m+1} = 0, \dim\ker(A_{m}) = k ),
\]
which goes to $n$ has $q$ goes to infinity by Theorem~\ref{Condptoinfty}.
\end{proof}
\end{corollary}
