Recall that a chain complex consists of a pair of sequences $(C_n, \delta_n)$,
where the $C_n$ are appropriate spaces (vector spaces, groups, modules, etc.)
and the $\delta_n$ are maps, $\delta_n: C_n \to C_{n-1}$ such that
$\delta_{n-1}\delta_n = 0$.  

Let $q$ be a prime number and let $\Fq$ denote the field with $q$ elements. Let
$n_m$ be a sequence of natural numbers. Consider the sequence of finite vector
spaces $\Fqn{n_m}$ indexed by $m$.  We iteratively construct a sequence $A_m$
of boundary maps from $\Fq^{n_m}$ into $\Fq^{n_{m-1}}$.

Let $A_0:\Fq^{n_0} \to 0$ be the zero map. Suppose for $m>0$ that
$A_{m}:\Fq^{n_m} \to \Fq^{n_{m-1}}$ is known. Let $A_{m+1}$ be the random map
that is given by the random $(n_{m})\times (n_{m+1})$ matrix whose entries are
chosen i.i.d. uniformly from $\Fq$, subject to the condition that $A_{m+1}A_{m}
= 0$.

\begin{definition} 
  \label{defn:random_chain_cx}
  Let $n_m$ be a sequence of natural numbers. A \textbf{random chain complex}
  is a pair $(\Fqn{n_m},A_m)$, where $A_m$ is an iteratively defined sequence
  of random linear transformations given by random $(n_{m-1})\times (n_m)$
  matrices, as defined above.
\end{definition}

We wish to investigate the probabilistic properties of the homology of a random
chain complex.  We are primarily interested in the distribution of the Betti
numbers $\beta_m := \dim(H_m(A_\ast; \Fqn{n}))$.  Recall that
$H_m(A_\ast;\Fqn{n}) = \ker (A_{m})/ A_{m+1}(\Fqn{n})$, so if $k= \ker(A_m)$,
then $\beta_m = k - \rank(A_{m+1})$.  We are therefore interested in the
probabilistic properties of $\rank(A_{m+1})$ given that $A_{m}A_{m+1} = 0$ and
that $\nul(A_{m}) = k$. 


\begin{remark}
As the $A_m$ of a random chain complex are uniformly distributed, Definition
\ref{defPkmr} immediately gives us that
\[
  P^m_k(r) = \mathbb{P}\left[\beta_m = k-r | \nul(A_{m}) = k\right].
\]
\end{remark}

\mz{If we know anything about $\lim_{q\to\infty} \Fq$, we should state it here.}


We are now ready to state our first theorem.

\mz{Letting $k\leq n_{m+1}$ seems fine to me, but what about Definition \ref{defPkmr}?}

\begin{theorem}\label{Condptoinfty}
Let $\beta_m$ be the $m$-th Betti number of a random chain complex.  If $k\leq n_{m+1}$, then
\[
\mathbb{P}\left[\beta_m=0| \nul(A_{m}) = k \right] \to 1 \textrm{ as } q\to\infty.
\]
\end{theorem}

\begin{proof}
We have
	\begin{eqnarray*}
	&&\mathbb{P}\left[\beta_m = 0|A_{m}A_{m+1} = 0, \nul(A_{m}) = k \right]\\ 
    &=& P^m_k(k)\\
    &=& \frac{\prod_{j=0}^{k-1}(q^{n_{m+1}}-q^{j})
		\prod_{j=0}^{k-1}(q^k - q^j )}
		{q^{kn_{m+1}} \prod_{j=0}^{k-1} (q^k-q^j)}\\
		&=& \frac{\prod_{j=0}^{k-1}(q^{n_{m+1}} - q^j)}
		{q^{kn_{m+1}}} \\
		%&=& \frac{\prod_{j=0}^{k-1}(q^{n_{m+1}} - q^j)}{q^{n_{m+1}k}}\\
		&=& \frac{q^{kn_{m+1}}}{q^{kn_{m+1}}}\prod_{j=0}^{k-1}(1-q^{j-n_{m+1}})\\
		&=& \prod_{j=0}^{k-1} (1-q^{j-n_{m+1}}),
	\end{eqnarray*}
which tends to 1 as $q\to\infty$.  
\end{proof}

The previous theorem immediately leads to two corollaries.  

\begin{corollary}\label{condtozero}
Let $\beta_m$ be the $m$-th Betti number of a random chain complex. Let $b$ be a positive integer that is less than or equal to $k$. Then 
\[
\mathbb{P}[\beta_m = b| \nul(A_{m}) = k ] \to 0 \textrm{ as } q\to\infty.
\]
\end{corollary}
\begin{proof}
We have that
	\begin{eqnarray*}
	&&\mathbb{P}[\beta_m = b \st A_{m}A_{m+1} = 0, \nul(A_{m}) = k ]\\
    &=& 1 - \sum_{j\neq b}\mathbb{P}[\beta_0 = j \st A_{m}A_{m+1} = 0, \nul(A_{m}) = k ]\\
    &\leq& 1 - \mathbb{P}(\beta_m = 0|A_{m}A_{m+1} = 0, \dim\ker(A_{m}) = k ).
	\end{eqnarray*}
By Theorem~\ref{Condptoinfty}, this goes to $0$ as $q$ goes to infinity.
\end{proof}

\begin{corollary}
Let $\beta_m$ be the $m$-th Betti number of a random chain complex.  Then 
\[
\mathbb{E}[\beta_m | \nul(A_{m}) = k ] \to n \textrm{ as } q\to\infty.
\]
\begin{proof}
The conditional expectation of the $m$-th Betti number is given by
	\begin{eqnarray*}
	& & \mathbb{E}[\beta_m | A_{m}A_{m+1} = 0, \dim\ker(A_{m}) = k ]\\
	&=& \sum_{b=1}^n b \mathbb{P}(\beta_m = b | A_{m}A_{m+1} = 0, \dim\ker(A_{m}) = k ) \, .
	\end{eqnarray*}
By Corollary \ref{condtozero}, all terms with $b< n$ in this sum tend to 
$0$ as $q$ goes to infinity. 

On the other hand, when $b=n$, 
\[
n\mathbb{P}(\beta_m=0| A_{m}A_{m+1} = 0, \dim\ker(A_{m}) = k ),
\]
which goes to $n$ has $q$ goes to infinity by Theorem~\ref{Condptoinfty}.
\end{proof}
\end{corollary}

We next derive explicit formulas for the distributions of the Betti numbers of a random chain complex. We first need a lemma

\begin{lemma}\label{lemProbranks}
Let $(\Fq^{n_m}, A_m)$ be a random chain complex with $A_0:\Fq^{n_0}\to 0$.  Then
\begin{align*}
 &  \mathbb{P}\left[\rank(A_{m+1}) = n_{m+1} - k\right]\\
=& 	\sum_{i_m=0}^{n_m} P_{i_m}^{m}\left(n_{m+1} -k\right)
	\sum_{i_{m-1}=0}^{n_{m-1}} P_{i_{m-1}}^{m-1}\left(n_m - i_m\right)
		\cdots
	\sum_{i_1 = 0}^{n_1} P_{i_1}^1\left(n_2 - i_2\right) P_{n_0}^0 \left(n_1 - i_1\right) 
\end{align*}
\end{lemma}
\begin{proof}
The proof is by induction on $m$. For the basis step $m=1$, we have
\begin{align*}
\mathbb{P}\left[\rank(A_1) = n_1 - k\right]
	=& \sum_{i_0=0}^{n_0}\mathbb{P}\left [\rank(A_1)= n_1 - k|\nul (A_0) = i_0\right]
		\mathbb{P}\left[\nul(A_0) = i_0 \right]\\
	=& \mathbb{P}\left [\rank(A_1)= n_1 - k|\nul (A_0) = n_0\right]\\
	=& P_{n_0}^0(n_1 - k).
\end{align*}
The first equality follows by the Law of Total Probability, and the second equality follows because $A_0$ is the zero map.

For the inductive step, suppose that
\begin{align*}
 &  \mathbb{P}\left[\rank(A_{m}) = n_{m} - i_{m}\right]\\
=& 	\sum_{i_{m-1}=0}^{n_{m-1}} P_{i_{m-1}}^{m-1}\left(n_{m} -i_{m}\right)
	\sum_{i_{m-2}=0}^{n_{m-2}} P_{i_{m-2}}^{m-2}\left(n_{m-1} - i_{m-1}\right)
		\cdots
	\sum_{i_1 = 0}^{n_1} P_{i_1}^1\left(n_2 - i_2\right) P_{n_0}^0 \left(n_1 - i_1\right).
\end{align*}
We must show that
\begin{align*}
 &  \mathbb{P}\left[\rank(A_{m+1}) = n_{m+1} - k\right]\\
=& 	\sum_{i_m=0}^{n_m} P_{i_m}^{m}\left(n_{m+1} -k\right)
	\sum_{i_{m-1}=0}^{n_{m-1}} P_{i_{m-1}}^{m-1}\left(n_m - i_m\right)
		\cdots
	\sum_{i_1 = 0}^{n_1} P_{i_1}^1\left(n_2 - i_2\right) P_{n_0}^0 \left(n_1 - i_1\right) 
\end{align*}
Note that
\begin{align*}
 &	\mathbb{P}\left[\rank(A_{m+1}) = n_{m+1} - k\right]\\
=& 	\sum_{i_{m}}^{n_{m}} \mathbb{P}\left[ \rank(A_{m+1}) = n_{m+1} - k  \right|\nul(A_m) = i_m]
		\mathbb{P}\left[\nul(A_m) = i_m\right]\\
=&  \sum_{i_{m}}^{n_{m}} P_{i_m}^{n_m}(n_{m+1} - k)
		\mathbb{P}\left[n_m - \rank(A_m) = i_m\right]\\
=&	\sum_{i_{m}}^{n_{m}} P_{i_m}^{n_m}(n_{m+1} - k)
		\mathbb{P}\left[\rank(A_m) = n_m- i_m\right].\\
\end{align*}
The desired result now follows by the induction hypothesis.
\end{proof}

\begin{theorem} Let $\beta_j$ be the $j$-th Betti number of the random chain complex $(\Fq^{n} , A_m)$. Then
	\[    
    \bP[\beta_j = b] = \sum_{k=0}^{n_{m}} P_{k}^{m}(k-b)\sum_{i_m=0}^{n_m} P_{i_m}^{m}\left(n_{m+1} -k\right)
		\cdots
	\sum_{i_1 = 0}^{n_1} P_{i_1}^1\left(n_2 - i_2\right) P_{n_0}^0 \left(n_1 - i_1\right).
    \]
\end{theorem}
\begin{proof}
We have

\begin{align*}
  \mathbb{P}[\beta_{m} = b] 
   &= \mathbb{P}[\nul(A_{m}) - \rank(A_{m+12}) = b]\\
   &= \mathbb{P}[\rank(A_{m+1}) = \nul(A_{m}) - b]\\
   &= \sum_{k=0}^{n_{m}}\mathbb{P}[\rank(A_{m+1}) = k - b| \nul(A_{m})=k] \mathbb{P}[\nul(A_{m}) = k]\\
   &= \sum_{k=0}^{n_{m}} P_{k}^{m}(k-b)\mathbb{P}[n_{m+1} - \rank(A_{m}) = k]\\
   &= \sum_{k=0}^{n_{m}} P_{k}^{m}(k-b)\mathbb{P}[\rank(A_{m+1}) = n_{m} - k]\\ 
\end{align*}
By Lemma \ref{lemProbranks} we have
\begin{align*}
 & \sum_{k=0}^{n_{m}} P_{k}^{m}(k-b)\mathbb{P}[\rank(A_{m+1}) = n_{m} - k] \\
=& \sum_{k=0}^{n_{m}} P_{k}^{m}(k-b)\sum_{i_m=0}^{n_m} P_{i_m}^{m}\left(n_{m+1} -k\right)
		\cdots
	\sum_{i_1 = 0}^{n_1} P_{i_1}^1\left(n_2 - i_2\right) P_{n_0}^0 \left(n_1 - i_1\right), 
\end{align*}
as desired.
\end{proof}
